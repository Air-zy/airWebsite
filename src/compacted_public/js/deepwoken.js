// minified by avy <3
async function fetchTalents(){try{const e=await fetch("https://api.deepwoken.co/get?type=talent&name=all");if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return await e.json()}catch(e){console.error("There was a problem with the fetch operation:",e)}}function calculateReqSum(e){let t=0;return e.base&&Object.values(e.base).forEach((e=>{t+=e})),e.weapon&&Object.values(e.weapon).forEach((e=>{t+=e})),e.attunement&&Object.values(e.attunement).forEach((e=>{t+=e})),t}function calculateCost(e){let t=0;for(let n in e.base)t+=e.base[n];for(let n in e.weapon)t+=e.weapon[n];for(let n in e.attunement)t+=e.attunement[n];return t}function generateAllAttributes(e){const t={},n={};Object.keys(e).forEach((a=>{const s=e[a];for(let e in s.reqs.base)t.hasOwnProperty(e)||(t[e]=0,n[e]=new Set),n[e].add(s.reqs.base[e]);for(let e in s.reqs.weapon)t.hasOwnProperty(e)||(t[e]=0,n[e]=new Set),n[e].add(s.reqs.weapon[e]);for(let e in s.reqs.attunement)t.hasOwnProperty(e)||(t[e]=0,n[e]=new Set),n[e].add(s.reqs.attunement[e])}));for(let e in n)n[e]=Array.from(n[e]).sort(((e,t)=>e-t));return{totalRequirements:t,uniqueValues:n}}function countSumReqs(e){let t=0;for(let n in e.base)t+=e.base[n];for(let n in e.attunement)t+=e.attunement[n];for(let n in e.weapon)t+=e.weapon[n];return t}function checkIfTalentCanBeUnlocked(e,t){if(e.length<1)return!1;let n=!0;for(let a in t.base)if(n=!1,e[a]<t.base[a])return!1;for(let a in t.attunement)if(n=!1,e[a]<t.attunement[a])return!1;for(let a in t.weapon)if(n=!1,e[a]<t.weapon[a])return!1;return 1!=n}function printKeyValuePairsInline(e){const t=Object.entries(e).map((([e,t])=>`${e}: ${t}`)).join(", ");console.log(t)}let talentEntries;const buildPrompt="",minimumStatUse=1;function unlockTalents(e){const t=Object.keys(e).filter((t=>countSumReqs(e[t].reqs)>1)).reduce(((t,n)=>(t[n]=e[n],t)),{}),n=generateAllAttributes(t),a=n.totalRequirements,s=n.uniqueValues;for(let e in s)s[e].reverse();const o=function(){const e={};for(let n in t)e[n]=1;return e}();console.warn(a);const r=Object.keys(a),c=r.length;let l=0;const i=performance.now();let u=0;!function e(t,n,a){if(n<0)return;if(t===c){if(0===n){let e=function(e){let t=0;return talentEntries.forEach((n=>{checkIfTalentCanBeUnlocked(e,n.reqs)&&(t+=o[n.name])})),t}(a);e>l&&(l=e,console.log("at",u,"score:",e),printKeyValuePairsInline(a)),u++}return}const i=r[t],d=s[i];for(let s=0;s<d.length;s++){const o=d[s];a[i]=o,e(t+1,n-o,a)}}(0,60,{...a});const d=performance.now();console.log(`Execution time: ${d-i} milliseconds`),console.log("Total Combinations: ",u),console.warn("all possible stats of talents: ",s)}const mainElement=document.querySelector("main");async function main(){const e=await fetchTalents();Object.keys(e).forEach((t=>{"thank you"===t.toLowerCase()&&delete e[t]})),talentEntries=Object.keys(e).map((t=>({name:t,reqs:e[t].reqs}))).filter((e=>countSumReqs(e.reqs)>1));Object.keys(e).sort(((t,n)=>{let a=.9*calculateReqSum(e[t].reqs),s=.9*calculateReqSum(e[n].reqs);0==a&&(a=20),0==s&&(s=20),e[t].desc.match(/\b(damage|resistance|buff|health|m1's)\b|\d+%|\d+/i)&&(a+=40),e[n].desc.match(/\b(damage|resistance|buff|health|m1's)\b|\d+%|\d+/i)&&(s+=40),e[t].desc.match(/\b(m1's|break|breaking|less damage|more damage|basic attack|rolling|feast)\b/i)&&(a+=40),e[n].desc.match(/\b(m1's|break|breaking|less damage|more damage|basic attack|rolling|feast)\b/i)&&(s+=40);const o=e[t].name.toLowerCase(),r=e[n].name.toLowerCase();return(o.includes("ether overdrive")||o.includes("adept")||o.includes("expert")||/master\s/.test(o))&&(a-=100),(r.includes("ether overdrive")||r.includes("adept")||r.includes("expert")||/master\s/.test(r))&&(s-=100),o.includes("unbounded")&&(a-=100),r.includes("unbounded")&&(s-=100),"Umami"==e[t].name&&(a+=60),"Umami"==e[n].name&&(s+=60),s-a})).forEach((t=>{const n=e[t],a=document.createElement("div");a.classList.add("entry");const s=document.createElement("h2");s.textContent=n.name;const o=document.createElement("div");if(o.classList.add("entry-header"),o.appendChild(s),n.category){const e=document.createElement("span");e.textContent=`${n.category}`,o.appendChild(e)}if(a.appendChild(o),n.desc){const e=document.createElement("p");e.textContent=`${n.desc}`,a.appendChild(e)}if(n.rarity){const e=document.createElement("p");e.textContent=`${n.rarity} Talent`,a.appendChild(e)}if(n.reqs.from){const e=document.createElement("p");e.textContent=`from: ${n.reqs.from}`,a.appendChild(e)}if("N/A"!=n.stats){const e=document.createElement("p");e.textContent=`${n.stats}`,a.appendChild(e)}let r="";n.reqs.base&&Object.keys(n.reqs.base).forEach((e=>{n.reqs.base[e]>0&&(r+=`${n.reqs.base[e]} ${e},  `)})),n.reqs.weapon&&Object.keys(n.reqs.weapon).forEach((e=>{n.reqs.weapon[e]>0&&(r+=`${n.reqs.weapon[e]} ${e},  `)})),n.reqs.attunement&&Object.keys(n.reqs.attunement).forEach((e=>{n.reqs.attunement[e]>0&&(r+=`${n.reqs.attunement[e]} ${e},  `)}));const c=document.createElement("div");if(r){c.classList.add("entry-footer");const e=document.createElement("p");e.textContent=`${r}`,c.appendChild(e),a.appendChild(c)}if(n.exclusiveWith.length>1||""!==n.exclusiveWith[0]){c.classList.add("entry-footer");const e=document.createElement("button");e.textContent="Show Mutual Exclusives",e.classList.add("dropdown-button");const t=document.createElement("ul");t.classList.add("exclusive-list"),t.style.display="none",n.exclusiveWith.forEach((e=>{const n=document.createElement("li");n.textContent=e,t.appendChild(n)})),e.addEventListener("click",(()=>{const n="none"===t.style.display;t.style.display=n?"block":"none",e.textContent=n?"Hide Mutual Exclusives":"Show Mutual Exclusives"})),c.appendChild(e),c.appendChild(t),a.appendChild(c)}console.log(t),mainElement.appendChild(a)}))}main();